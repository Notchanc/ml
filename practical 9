Aim: Implementing the K-means clustering algorithm to identify distinct clusters in a customer demographic dataset.


code=

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.cluster import KMeans
import plotly as py
import plotly.graph_objs as go
from plotly.offline import iplot   # or use py.offline.iplot

# Install plotly if needed (for Jupyter environments)
!pip install plotly

# Load dataset
df = pd.read_csv('Mall_Customers.csv')

# Quick exploration
print(df.head())
print(df.shape)
print(df.info())
print(df.describe())
print(df.isna().sum())

# Pairplot
sns.pairplot(df, hue='Gender')

# Select features
x = df[['Age', 'Annual Income (k$)', 'Spending Score (1-100)']]

# Elbow method
inertia = []
for n in range(1, 11):
    kmeans = KMeans(n_clusters=n, init='k-means++', n_init=10, random_state=111, algorithm='elkan')
    kmeans.fit(x)
    inertia.append(kmeans.inertia_)

plt.figure(1, figsize=(15, 6))
plt.plot(np.arange(1, 11), inertia, 'o')
plt.plot(np.arange(1, 11), inertia, '-', alpha=0.5)
plt.xlabel('Number of Clusters')
plt.ylabel('Inertia')
plt.show()

# Choose 6 clusters (based on elbow plot)
kmeans = KMeans(n_clusters=6, init='k-means++', n_init=10, random_state=111, algorithm='elkan')
y_kmeans = kmeans.fit_predict(x)      # fits and returns labels
centroids = kmeans.cluster_centers_

# Add cluster labels to original dataframe
df['cluster'] = y_kmeans
print(df.head())

# 3D scatter plot with Plotly
trace1 = go.Scatter3d(
    x=df['Age'],
    y=df['Spending Score (1-100)'],
    z=df['Annual Income (k$)'],
    mode='markers',
    marker=dict(
        color=df['cluster'],
        size=10,
        line=dict(color=df['cluster'], width=12),
        opacity=0.8
    )
)

data = [trace1]
layout = go.Layout(
    title='Clusters wrt Age, Income and Spending Scores',
    scene=dict(
        xaxis=dict(title='Age'),
        yaxis=dict(title='Spending Score'),
        zaxis=dict(title='Annual Income')
    )
)

fig = go.Figure(data=data, layout=layout)
py.offline.iplot(fig)   # or iplot(fig) if you imported iplot directly
